<% @credit_groups.each do |group| %>

  <div class="group-container">
    <%= content_tag(:h3, group.title) unless current_user.groups.count == 1 %>

    <div class="expenses-container">

      <% @credits = group.credits.select { |exp| exp.active && exp.creditor == current_user }.reverse %>
      <% @credits.each do |expense| %>

        <div class="expense">
          <span class="expense-price"><%= number_to_currency expense.amount %></span>
          <span class="expense-debtor"><%= link_to expense.debtor.first_name, credits_path(expense.debtor) %></span>

          <div class="info-stack">
            <span class="expense-title"><%= expense.title %></span>
            <span class="expense-date"><%= render_date expense.created_at %></span>
          </div>

          <%= render 'stale_badge', expense: expense %>

          <div class="expense-actions">
            <%= link_to raw("<i class='icon-ok icon-white'></i>"),
              { action: 'destroy', id: expense.id, redirect: expenses_path},
              { :method => :delete,
              confirm: "Mark #{number_to_currency(expense.amount)} from #{expense.debtor.first_name} completed?",
              class: "btn no-text btn-green",
              id: "delete-expense" }
            %>
          </div>
        </div><!-- .expense -->

      <% end %>

    </div><!-- .expenses-container -->
  </div><!-- .group-container -->

  <% if @credits.count > 1 %>
    <p class="expense-total">You are owed <%= number_to_currency(current_user.total_credit_owed) %>.</p>
  <% end %>

<% end %>
